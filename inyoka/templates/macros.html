{#
    macros.html
    ~~~~~~~~~~~

    This is a file that contains all template parts that are used more than
    once in macros.

    :copyright: (c) 2007-2015 by the Inyoka Team, see AUTHORS for more details.
    :license: BSD, see LICENSE for more details.
#}
{#
    render_form
    ===========

    This macro renders a bunch of form fields automatically.
    Set the `inline` parameter to `true`, if you want to add a field manually
    to the <dl> element.

    :copyright: (c) 2007-2015 by the Inyoka Team, see AUTHORS for more details.
    :license: BSD, see LICENSE for more details.
#}
{% macro render_form(form, fields, inline=false) %}
{%- if not inline %}
<dl>
{%- endif %}
  {%- for field in fields %}
  {%- if form[field] %}
  <dt>
    <label for="{{ form[field].auto_id }}">{{ form[field].label }}:</label>
  </dt>
  <dd>
    {{ form[field] }} {{ form.errors[field] }}
    {%- if form[field].help_text %}
    <p class="note">{{ form[field].help_text }}</p>
    {%- endif %}
  </dd>
  {%- endif %}
  {%- endfor %}
{%- if not inline %}
</dl>
{%- endif %}
{%- endmacro %}

{# render a list entry of the mod nav #}
{% macro render_modnavi_li(label, href, icon, count=False) %}
  <a href="{{ href|e }}"{% if count %} class="highlight"{% endif %}>{#
    #}<img src={{ icon|e }} alt="{{ label }}" title="{{ label }} ({{ count }})" />{#
    #}<span class="description">{{ count }}</span>{#
  #}</a>
{% endmacro %}

{# Pagination macro #}
{% macro render_pagination(pagination, show_prev=True, show_next=True, threshold=2) %}
  {%- if show_prev -%}
    {%- if pagination.prev -%}
      <a href="{{ pagination.prev }}" class="prev">« {% trans %}Previous{% endtrans %}</a>
    {%- else -%}
      <span class="disabled prev">« {% trans %}Previous{% endtrans %}</span>
    {%- endif -%}
    <span class="comma">, </span>
  {%- endif -%}
  {% for link in pagination.list(threshold) -%}
    {%- if link['type'] == 'spacer' -%}
      <span class="ellipsis">…</span>
    {%- elif link['type'] == 'current' -%}
      <span class="pageselect active">{{ link['page'] }}</span>
    {%- else -%}
      <a href="{{ link['url'] }}" class="pageselect">{{ link['page'] }}</a>
    {%- endif -%}
    {% if not loop.last or show_next %}<span class="comma">, </span>{% endif %}
  {%- endfor -%}
  {%- if show_next -%}
    {%- if pagination.next -%}
      <a href="{{ pagination.next }}" class="next">{% trans %}Next{% endtrans %} »</a>
    {%- else -%}
      <span class="disabled next">{% trans %}Next{% endtrans %} »</span>
    {%- endif -%}
  {%- endif %}
{% endmacro %}


{# Pagination macro for small paginations in topic list views #}
{% macro render_small_pagination(pagination, threshold=2) %}
  {% for link in pagination.list() -%}
    {%- if link['type'] == 'spacer' -%}
      <span class="ellipsis">…</span>
    {%- else -%}
      <a href="{{ link['url'] }}" class="pageselect">{{ link['page'] }}</a>
    {%- endif -%}
    {% if not loop.last %}<span class="comma">, </span>{% endif %}
  {%- endfor -%}
{% endmacro %}


{# Pagination macro for mobile #}
{% macro render_pagination_mobile(pagination, threshold=2) %}
  {%- if pagination.first -%}
    <a href="{{ pagination.first }}" class="prev first">«</a>
  {%- endif -%}
  {%- if pagination.prev -%}
    <a href="{{ pagination.prev }}" class="prev">« {% trans %}Previous{% endtrans %}</a>
  {%- endif -%}
  <span class="active">{% trans %}Page{% endtrans %} {{ pagination.page }} / {{ pagination.pages }}</span>
  {%- if pagination.next -%}
    <a href="{{ pagination.next }}" class="next">{% trans %}Next{% endtrans %} »</a>
  {%- endif -%}
  {%- if pagination.last %}
    <a href="{{ pagination.last }}" class="next last">»</a>
  {%- endif -%}
{% endmacro %}
