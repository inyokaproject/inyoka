$(function(){(function(){JSTableForm=function(k,z){function t(b){b.addClass("jstableform-status-no").removeClass("jstableform-status-yes")}function u(b){b.addClass("jstableform-status-yes").removeClass("jstableform-status-no")}function v(){switch(n($(this))){case true:t($(this));break;case false:u($(this));break;default:}}function n(b){if(b.hasClass("jstableform-status-yes"))return true;else if(b.hasClass("jstableform-status-no"))return false;return null}function o(){var b=$(this).parent().attr("name").substring(16);
b=l[b].validator;if(b!=null)b($(this).val())?$(this).removeClass("invalid"):$(this).addClass("invalid")}function w(b){b.preventDefault();$(this).parent().parent().remove()}function A(b){b.preventDefault();var d=$(this).parent().parent(),g=d.attr("name").substring(12);$.each(m,function(f,c){var a=l[c],e=d.find('[name="jstableform-key-'+c+'"]');if(a.type=="string"||a.type=="int"||a.type=="float"||a.type=="text"){e.empty();e.text(p[g][c])}else if(a.type=="boolean"){p[g][c]?u(e):t(e);e.unbind("click");
e.removeClass("pointer")}else if(a.type=="_edit"){a=$('<a href="#'+q+'">\u00c4ndern</a>');e.empty();a.click(x).appendTo(e)}});delete p[g];delete r[g]}function x(b){b.preventDefault();var d=$(this).parent().parent();b=d.attr("name").substring(12);var g={};$.each(m,function(f,c){var a=l[c],e=d.find('[name="jstableform-key-'+c+'"]');if(a.type=="string"||a.type=="int"||a.type=="float"){a=$('<input type="text"/>');a.blur(o);g[c]=e.text();a.val(e.text());e.empty();a.appendTo(e)}else if(a.type=="text"){a=
$("<textarea></textarea>");a.blur(o);g[c]=e.text();a.val(e.text());e.empty();a.appendTo(e)}else if(a.type=="boolean"){g[c]=n(e);e.addClass("pointer");e.click(v)}else if(a.type=="_edit"){a=$('<a href="#'+q+'">Abbrechen</a>');e.empty();a.click(A);a.appendTo(e)}});p[b]=g;r[b]=true}var B=/^\d+$/,C=/^\d+|\d+\.\d+|\.\d+$/,D=/^\d\d?\.\d\d$/,E=/^[A-Z][a-z]+ [A-Z][a-z]+$/,p={},r={},q=k.attr("id")||"",s={"int":function(b){return B.test(b)},"float":function(b){return C.test(b)},versionnumber:function(b){return D.test(b)},
versionname:function(b){return E.test(b)}},l={},m=[];$('td[class="jstableform-_jswarning"]',k).parent().remove();$("thead tr td",k).each(function(){classes=$(this).attr("class").split(" ");var b,d={key:null,type:null,validator:null};$.each(classes,function(g,f){if(f.indexOf("jstableform-")==0){f=f.substring(12);if(f.indexOf("key-")==0){b=f.substring(4);d.key=b;if(b=="_cmdedit"){d.type="_edit";return true}else if(b=="_cmddel"){d.type="_delete";return true}}else if(f.indexOf("type-")==0){d.type=f.substring(5);
if(d.type=="int"&&d.validator==null)d.validator=s["int"];else if(d.type=="float"&&d.validator==null)d.validator=s["float"]}else if(f.indexOf("validate-")==0)d.validator=s[f.substring(9)]}});l[b]=d;m.push(b)});$('a[name="jstableform-add"]',k).click(function(b){b.preventDefault();var d=$('<tr name="jstableform-_new"></tr>');$.each(m,function(g,f){var c=l[f],a=$('<td name="jstableform-key-'+f+'"></td>');if(c.type=="string"||c.type=="int"||c.type=="float"){c=$('<input type="text"/>');c.blur(o);c.appendTo(a)}else if(c.type==
"text"){c=$("<textarea></textarea>");c.blur(o);c.appendTo(a)}else if(c.type=="boolean"){a.addClass("jstableform-status-no");a.addClass("pointer");a.click(v)}else if(c.type!="_edit")if(c.type=="_delete"){c=$('<a href="#'+q+'">L\u00f6schen</a>');c.click(w);c.appendTo(a)}a.appendTo(d)});$("tbody",k).append(d)});$('td[name|="jstableform-key-_cmdedit"] a',k).click(x);$('td[name|="jstableform-key-_cmddel"] a',k).click(w);$('input[type="submit"]').click(function(b){var d=[],g,f;$('tr[name^="jstableform-"]').each(function(){g=
$(this);var c=g.attr("name").substring(12);f=c=="_new";var a={};f||r[c]?$.each(m,function(e,i){var h=l[i],j=g.find('[name="jstableform-key-'+i+'"]');if(h.type=="string"||h.type=="int"||h.type=="float"||h.type=="text"){j=$("input",j).val();var y=true;if(h.validator!==null)y=h.validator(j);y||b.preventDefault();a[i]=j}else if(h.type=="boolean")a[i]=n(j)}):$.each(m,function(e,i){var h=l[i],j=g.find('[name="jstableform-key-'+i+'"]');if(h.type=="string"||h.type=="int"||h.type=="float"||h.type=="text")a[i]=
j.text();else if(h.type=="boolean")a[i]=n(j)});d.push(a)});z.val(window.JSON.stringify(d))})}})()});
