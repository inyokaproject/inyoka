(function(){PrivilegeBox=function(j,s,p){this.mapping={};var q,b=[],g=this,o=$('<ul class="forums" />');this.container=$(j);$.each(s,function(l,i){var d=i[0],k=i[1],m=i[2],h=i[3];g.mapping[d]=m.concat($.map(h,function(e){return e*-1}));d=$("<li />").text(k).attr("id","forum_"+d);if(m!=""||h!="")d.css("color","#E00");o.append(d.click(function(e){var a=$(this).attr("id").split("_")[1];if(e.ctrlKey){e=$.inArray(a,b);e>-1&&b.length>1&&b.splice(e,1);e==-1&&b.push(a)}else b=[a];$(this).parent().children().removeClass("active");
$.each(b,function(c,n){$("#forum_"+n).addClass("active")});if(b.length==1){var f=b[0];r.text($("#forum_"+f).text());$.each(p,function(c){c=parseInt(c,10);var n;n=$.inArray(c,g.mapping[f])>-1?"1":$.inArray(c*-1,g.mapping[f])>-1?"-1":"0";$("#priv_"+c+"_"+n).attr("checked","checked")})}else{r.text(b.length+" Foren");$("input[type=radio]",g.container).attr("checked","")}}))});this.container.html("");this.container.append(o);j=$('<div class="privileges"></div>').appendTo(this.container);var r=$("<h5 />").appendTo(j),
t=$("<dl />").appendTo(j);$.each(p,function(l,i){var d=function(k,m){return $('<input type="radio" />').attr({name:"priv_"+l,value:k,id:"priv_"+l+"_"+k}).change(function(){var h=[];g.container.find("input").each(function(e,a){if(a.name.substring(0,5)=="priv_"&&a.checked){var f=parseInt(a.name.substring(5),10);if(q=parseInt(a.value,10)*f)h[h.length]=q}});$.each(b,function(e,a){var f="forum_privileges_"+a,c=$("input[name="+f+"]");if(c.length===0)c=$('<input type="hidden" />').attr("name",f).appendTo(g.container);
g.mapping[a]=h;c.val(h.join(","))})}).add($("<label />").attr("for","priv_"+l+"_"+k).text(m))};t.append($("<dt />").text(i),$("<dd />").append(d(1,"Ja"),d(0,"Nicht gesetzt"),d(-1,"Nein")))});$(o.children()[0]).click();j.append('<span class="note">Halte die Steuerungs-Taste gedr\u00fcckt, um mehrere Foren auszuw\u00e4hlen.</span>')}})();
