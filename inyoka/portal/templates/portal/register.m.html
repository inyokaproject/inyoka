{#
    portal/register.html
    ~~~~~~~~~~~~~~~~~~~~

    This page displays a formular where the user can register a new account.

    :copyright: (c) 2007-2012 by the Inyoka Team, see AUTHORS for more details.
    :license: GNU GPL, see LICENSE for more details.
#}

{%- extends 'portal/overall.m.html' %}
{% from 'macros.html' import render_form %}
{% do BREADCRUMB.append('Registrierung', href('portal', 'register'), True) %}
{% block content %}
  <h3>Registrierung</h3>
  <form action="" method="post">
		{{ csrf_token() }}
    {{ form.non_field_errors() }}
    <dl>
      {{ render_form(form, ['username', 'password', 'confirm_password',
                            'email'], inline=true)}}
      <dt>Nutzungshinweise:</dt>
      {# include the agreement letter #}
      <dd>{{ form.terms_of_usage }} <label for="id_terms_of_usage">Ich bestätige den <a href="{{ href('portal', 'lizenz') }}">Lizenztext</a> gelesen zu haben und erkläre mich mit der Veröffentlichung unter dieser Lizenz einverstanden.<br />Durch das Abschließen der Registrierung stimme ich den <a href="{{ href('portal', 'nutzungsbedingungen') }}">Nutzungsbedingungen</a> und <a href="http://wiki.ubuntuusers.de/ubuntuusers/Moderatoren/Forenregeln">Forenregeln</a> ebenfalls zu.</label><br />
      {{ form.errors.terms_of_usage }}</dd>
      <dd>{{ form.hidden_captcha }}</dd>
      <dd>{{ form.errors.hidden_captcha }}</dd>
      <dd style="display: none"><input type="submit" /></dd><!-- at enter the first submit button is used -->
      {{ render_form(form, ['captcha'], inline=true) }}
    </dl>
    <p>
      <input type="submit" value="Registrieren" />
    </p>
    <script type="text/javascript">
      /*<![CDATA[*/
      (function() {
        var img = $('img.captcha').load(function() {
          input.attr('disabled', '');
        });
        var captcha_url = img.attr('src').split('&')[0];
        var input = $('input[name="renew_captcha"]')
          .click(function() {
            input.attr('disabled', 'diabled');
            var uid = Math.random().toString().substring(2, 10);
            img.attr('src', captcha_url + '&rnd=' + uid);
            return false;
          });
        $('#id_username').focus();
      })();
      /*]]>*/
    </script>
  </form>
{% endblock %}
