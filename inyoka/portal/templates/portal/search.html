{#
    portal/search_results.html
    ~~~~~~~~~~~~~~~~~~~~~~~~~~

    This page displays the search results.

    :copyright: (c) 2007-2014 by the Inyoka Team, see AUTHORS for more details.
    :license: GNU GPL, see LICENSE for more details.
#}

{%- extends 'portal/overall.html' %}
{% from 'macros.html' import render_form %}
{% set navi_type = 'none' %}
{% set title = 'Suche' %}
{% set active_app = area %}
{% set deny_robots = 'noindex' %}
{% if query %}
  {% do BREADCRUMB.append('Ergebnisse für „%s“' % query, '', True) %}
{% endif %}
{% do BREADCRUMB.append('Suche', href('portal', 'search'), True) %}

{% block portal_content %}
  <h3>Suche</h3>
  <p>Hier kannst du nach Informationen im gesamten ubuntuusers Portal suchen.
  Die Suche berücksichtigt keine Groß- und Kleinschreibung und mehrere
  Suchausdrücke können mit <strong>UND</strong>, <strong>ODER</strong> sowie
  <strong>UND&nbsp;NICHT</strong> kombiniert werden, wobei gegebenenfalls
  eine Klammer zu setzen ist.  Weitere Informationen zur Suche auf ubuntuusers.de findet man im Wiki unter <a href="{{ href('wiki', 'Suchfunktion') }}">Suchfunktion</a>.</p>
  <form action="{{ href('portal', 'search') }}" method="GET" class="search_page">
    <p>{{ query }}</p>
    <input type="text" name="q" value="{{ query }}">
    <div class="submit">
      <input type="submit" value="Suchen" />
    </div>
  </form>



  {%- if query %}
    {% if object_list %}
      <div class="pagination pagination_right">
        {{ pagination.generate() }}
        <div style="clear: both"></div>
      </div>
    {% endif %}
    <ul class="search_results">
      {%- for doc in object_list if not doc.hidden %}
        <li>
          <h2>
            {% if doc.content_type() == 'forum.post' %}
              <img src="{{ href('static', 'img/icons/small/forum.png') }}" alt="{% trans %}Forum{% endtrans %}" title="{% trans %}Forum{% endtrans %}" />
              <a href="{{ doc.object.get_absolute_url() }}?highlight={{ query|urlencode|e }}">
                {{- doc.object.topic.title|search_highlight -}}
              </a>
            {% elif doc.content_type() == 'ikhaya.article' %}
              <img src="{{ href('static', 'img/icons/small/ikhaya.png') }}" alt="{% trans %}Ikhaya{% endtrans %}" title="{% trans %}Ikhaya{% endtrans %}" />
              <a href="{{ doc.object.get_absolute_url() }}?highlight={{ query|urlencode|e }}">
                {{- doc.object.subject|search_highlight -}}
              </a>
            {% elif doc.content_type() == 'wiki.page' %}
              <img src="{{ href('static', 'img/icons/small/wiki.png') }}" alt="{% trans %}Wiki{% endtrans %}" title="{% trans %}Wiki{% endtrans %}" />
              <a href="{{ doc.object.get_absolute_url() }}">
                {{- doc.title|search_highlight -}}
              </a>
            {% endif %}
    {#
            {%- if doc.solved %}
            <img src="{{ href('static', 'img/check.png') }}" alt="Gelöst" title="Gelöst" />
            {%- endif %}
            {%- if doc.version %}
            <span class="ubuntu_version">{{ doc.version }}</span>
            {%- endif %}
    #}
          </h2>
          <p class="description">
            {%- if doc.text -%}
              {{ doc.text|search_highlight }}
            {%- endif -%}
          </p>
        </li>
      {%- else %}
        <li class="no_results">{% trans %}No results found.{% endtrans %}</li>
      {%- endfor %}
    </ul>
    <br />
    {% if object_list %}
      <div class="pagination pagination_right">
        {{ pagination.generate() }}
        <div style="clear: both"></div>
      </div>
    {% endif %}
    <br clear="both" />
  {%- endif %}




{#      <p class="meta">
        {%- if doc.component in ('Forum', 'Ikhaya', 'Planet') %}
        geschrieben von <a href="{{ doc.user_url }}">{{ doc.user|e }}</a> {{ doc.date }}{% if not doc.component in ('Planet',) %} in <a href="{{ doc.group_url }}">{{ doc.group|e }}</a>{% endif %}
        {%- elif doc.component == 'Wiki' %}
        zuletzt bearbeitet von <a href="{{ doc.user_url }}">{{ doc.user|e }}</a> {{ doc.date }}
        {%- endif %}
        {%- if doc.component == 'Forum' %}
        <a href="{{ doc.last_post_url }}" alt="Springe zu letztem Beitrag"><img src="{{ href('static', 'img/forum/goto.png') }}" /></a>
        {%- endif %}
      </p>
  #}
  </div>
{% endblock %}